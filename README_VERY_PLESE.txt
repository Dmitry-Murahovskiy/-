Задача 44: В ячейке ниже представлен код генерирующий DataFrame, которая состоит всего из 1 столбца. Ваша задача перевести его в one hot вид. Сможете ли вы это сделать без get_dummies?

import random
lst = ['robot'] * 10
lst += ['human'] * 10
random.shuffle(lst)
data = pd.DataFrame({'whoAmI':lst})
data.head()
Статья про one hot вид


Приветствую, данную задачу решил двумя методами.

Первый метод заключается в том что мы используем  astype, который значительно сокращает написание кода(все мы знаем, что, краткость сестра таланта)

Второй же метод  немного отличается и поэтому хотелось бы расписать его подробно:

- Мы импортируем модуль random, чтобы использовать функцию random.shuffle().
- Создаем список lst, в котором 10 раз повторяется слово "robot" и 10 раз - "human".
- Перемешиваем элементы списка lst с помощью random.shuffle(lst).
- Создаем DataFrame data с единственным столбцом "whoAmI", значения которого взяты из списка lst.
- Получаем уникальные значения в столбце "whoAmI" с помощью data['whoAmI'].unique(). Это будут "robot" и "human".
- Создаем новый DataFrame one_hot_matrix с помощью pd.DataFrame(0, index=data.index, columns=unique_values). Это создает DataFrame с таким же количеством строк, как в data, и столбцами, соответствующими уникальным значениям из data['whoAmI'].unique(). Все ячейки этого DataFrame заполняются нулями.
- Используем цикл for для прохода по каждой строке DataFrame data.
- Для каждой строки мы получаем значение в столбце "whoAmI" и сохраняем его в переменной value.
- Затем мы обращаемся к соответствующей ячейке в one_hot_matrix с помощью one_hot_matrix.loc[i, value] и устанавливаем ее значение равным 1.

Таким образом, мы создали новый DataFrame one_hot_matrix, который представляет собой one-hot кодирование исходного DataFrame data. Каждая строка в one_hot_matrix содержит 1 в столбце, соответствующем значению в data['whoAmI'] для этой строки, и 0 во всех остальных столбцах.
